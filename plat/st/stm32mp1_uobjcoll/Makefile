#   uxmhf Makefile refactored to use the Ã¼berSpark next-gen toolkit
#   
#   author: ethan joseph <ethanj217@gmail.com>
#

.PHONY: all
all:
	@echo building uxmhf collection...
	uberspark staging switch uxmhf-pc 
	uberspark uobjcoll build -v --platform=pc --arch=x86_32 --cpu=generic .
	@echo built uxmhf collection successfully!

.PHONY: stage
stage:
	@echo creating staging
	uberspark staging create uxmhf-pc 
	uberspark staging config-set --setting-name=uobjcoll_binary_image_load_address --setting-value=0x06200000
	uberspark staging config-set --setting-name=uobj_binary_image_size --setting-value=0x14900000
	# uberspark staging config-set --root-dir=/home/yeeb16 --setting-name=bridge_cc_bridge --setting-value=container/amd64/x86_32/generic/gcc/v5.5.0
	# uberspark staging config-set --root-dir=/home/yeeb16 --setting-name=bridge_cc_bridge --setting-value=container/amd64/x86_32/generic/compcert/uxmhf-test
	uberspark staging config-set --setting-name=cc_bridge_namespace --setting-value=uberspark/bridges/container/amd64/cc-bridge/x86_32/generic/compcert/v3.1

#uxmhf-test
#v5.4.0
	uberspark staging config-set --setting-name=as_bridge_namespace --setting-value=uberspark/bridges/container/amd64/as-bridge/x86_32/generic/gnu-as/v2.26.1
	uberspark staging config-set --setting-name=ld_bridge_namespace --setting-value=uberspark/bridges/container/amd64/ld-bridge/x86_32/generic/gnu-ld/v2.26.1
	@echo staging created successfully!

.PHONY: clean
clean: 
	rm -rf _build
